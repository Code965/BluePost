{"ast":null,"code":"var _jsxFileName = \"/home/oem/Desktop/PedroTech/client/src/pages/Home.jsx\",\n  _s = $RefreshSig$();\nimport React from 'react';\nimport axios from 'axios';\nimport Css from '../Css/posts.css';\nimport { useEffect, useState, useContext } from 'react';\nimport { useNavigate } from \"react-router-dom\";\nimport { AuthContext } from '../helpers/AuthContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction Home() {\n  _s();\n  //STATI\n  const [post, setPost] = useState([]);\n  const [likedPosts, setLikedPosts] = useState([]);\n  const {\n    authState,\n    setAuthState\n  } = useContext(AuthContext);\n  let navigate = useNavigate();\n  //HOOKS\n\n  useEffect(() => {\n    //per le get ogni volta che fa il refresh pagina\n    if (!authState) {\n      navigate('/login');\n    } else {\n      axios.get('http://localhost:3002/posts/mostraPost', {\n        headers: {\n          accessToken: localStorage.getItem(\"Token\")\n        }\n      }).then(response => {\n        console.log(response.data);\n        setPost(response.data.listaPost); //li memorizza dentro lo stato\n        setLikedPosts(response.data.likedPosts.map(like => {\n          return like.PostId;\n        }));\n      });\n    }\n  }, []);\n  const miPiace = postId => {\n    axios.post(\"http://localhost:3002/likes/inserisciLike\", {\n      PostId: postId\n    }, {\n      headers: {\n        accessToken: localStorage.getItem(\"Token\")\n      }\n    }).then(response => {\n      //Dobbiamo aggiornare il post, per farlo dentro il metodo set\n      //andiamo a fare una map\n      //mi arriva il valore dal db, modifico il mio stato ma prima\n      //faccio un controllo e seleziono il post che mi interessa\n      //dopodiche` aggiorno il numero di like\n      setPost(post.map(post => {\n        if (post.id === postId) {\n          //ritorniamo il vecchio sato, andando a modificare il campo likes, quindi\n          //sommiamo le quantita`\n          if (response.data.liked) {\n            return {\n              ...post,\n              Likes: [...post.Likes, 0]\n            };\n          } else {\n            const likesArray = post.Likes;\n            likesArray.pop(); //rimuovo l;ultimo elemento\n            return {\n              ...post,\n              Likes: likesArray\n            };\n          }\n        } else {\n          return post;\n        }\n      }));\n      if (likedPosts.includes(postId)) {\n        setLikedPosts(likedPosts.filter(id => {\n          return id != postId;\n        }));\n      } else {\n        setLikedPosts([...likedPosts, postId]);\n      }\n    });\n  };\n\n  //FUNZIONI\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: post.map((value, key) => {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"container-post  \",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"items\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"nav-post flex-container justify-content align-center\",\n            children: /*#__PURE__*/_jsxDEV(\"h1\", {\n              children: value.title\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 98,\n              columnNumber: 25\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 97,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            onClick: () => {\n              navigate(`/Post/${value.id}`);\n            },\n            className: \"post-center flex-container justify-content align-center\",\n            children: /*#__PURE__*/_jsxDEV(\"ul\", {\n              className: \"list\",\n              children: /*#__PURE__*/_jsxDEV(\"li\", {\n                children: value.postText\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 103,\n                columnNumber: 25\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 102,\n              columnNumber: 25\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 101,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"username-post flex-container align-center \",\n            children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n              className: \"text\",\n              children: value.username\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 108,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"wrap\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => {\n                  miPiace(value.id);\n                },\n                className: likedPosts.includes(value.id) ? \"likeBtn\" : \"unlikeBtn\",\n                children: /*#__PURE__*/_jsxDEV(\"svg\", {\n                  xmlns: \"http://www.w3.org/2000/svg\",\n                  width: \"25\",\n                  height: \"25\",\n                  fill: \"currentColor\",\n                  class: \"bi bi-hand-thumbs-up\",\n                  viewBox: \"0 0 16 16\",\n                  children: /*#__PURE__*/_jsxDEV(\"path\", {\n                    d: \"M8.864.046C7.908-.193 7.02.53 6.956 1.466c-.072 1.051-.23 2.016-.428 2.59-.125.36-.479 1.013-1.04 1.639-.557.623-1.282 1.178-2.131 1.41C2.685 7.288 2 7.87 2 8.72v4.001c0 .845.682 1.464 1.448 1.545 1.07.114 1.564.415 2.068.723l.048.03c.272.165.578.348.97.484.397.136.861.217 1.466.217h3.5c.937 0 1.599-.477 1.934-1.064a1.86 1.86 0 0 0 .254-.912c0-.152-.023-.312-.077-.464.201-.263.38-.578.488-.901.11-.33.172-.762.004-1.149.069-.13.12-.269.159-.403.077-.27.113-.568.113-.857 0-.288-.036-.585-.113-.856a2.144 2.144 0 0 0-.138-.362 1.9 1.9 0 0 0 .234-1.734c-.206-.592-.682-1.1-1.2-1.272-.847-.282-1.803-.276-2.516-.211a9.84 9.84 0 0 0-.443.05 9.365 9.365 0 0 0-.062-4.509A1.38 1.38 0 0 0 9.125.111L8.864.046zM11.5 14.721H8c-.51 0-.863-.069-1.14-.164-.281-.097-.506-.228-.776-.393l-.04-.024c-.555-.339-1.198-.731-2.49-.868-.333-.036-.554-.29-.554-.55V8.72c0-.254.226-.543.62-.65 1.095-.3 1.977-.996 2.614-1.708.635-.71 1.064-1.475 1.238-1.978.243-.7.407-1.768.482-2.85.025-.362.36-.594.667-.518l.262.066c.16.04.258.143.288.255a8.34 8.34 0 0 1-.145 4.725.5.5 0 0 0 .595.644l.003-.001.014-.003.058-.014a8.908 8.908 0 0 1 1.036-.157c.663-.06 1.457-.054 2.11.164.175.058.45.3.57.65.107.308.087.67-.266 1.022l-.353.353.353.354c.043.043.105.141.154.315.048.167.075.37.075.581 0 .212-.027.414-.075.582-.05.174-.111.272-.154.315l-.353.353.353.354c.047.047.109.177.005.488a2.224 2.224 0 0 1-.505.805l-.353.353.353.354c.006.005.041.05.041.17a.866.866 0 0 1-.121.416c-.165.288-.503.56-1.066.56z\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 112,\n                    columnNumber: 29\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 111,\n                  columnNumber: 27\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 110,\n                columnNumber: 27\n              }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                children: value.Likes.length\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 115,\n                columnNumber: 27\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 109,\n              columnNumber: 25\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 107,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 19\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 15\n      }, this);\n    })\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 88,\n    columnNumber: 5\n  }, this);\n}\n_s(Home, \"o9COndrPPmA+wEFO9BNoBbj4vI8=\", false, function () {\n  return [useNavigate];\n});\n_c = Home;\nexport default Home;\nvar _c;\n$RefreshReg$(_c, \"Home\");","map":{"version":3,"names":["React","axios","Css","useEffect","useState","useContext","useNavigate","AuthContext","Home","post","setPost","likedPosts","setLikedPosts","authState","setAuthState","navigate","get","headers","accessToken","localStorage","getItem","then","response","console","log","data","listaPost","map","like","PostId","miPiace","postId","id","liked","Likes","likesArray","pop","includes","filter","value","key","title","postText","username","length"],"sources":["/home/oem/Desktop/PedroTech/client/src/pages/Home.jsx"],"sourcesContent":["import React from 'react'\nimport axios from 'axios'\nimport Css from '../Css/posts.css'\nimport {useEffect,useState, useContext} from 'react'\nimport { useNavigate } from \"react-router-dom\";\nimport { AuthContext } from '../helpers/AuthContext'\n\nfunction Home() {\n\n  //STATI\n  const [post,setPost] = useState([]);\n  const [likedPosts, setLikedPosts] = useState([]);\n\n  const { authState, setAuthState } = useContext(AuthContext);\n\n  let navigate = useNavigate()\n  //HOOKS\n\n \n\n  useEffect(() => { //per le get ogni volta che fa il refresh pagina\n    if(!authState){\n      navigate('/login');\n    }else{\n      axios.get('http://localhost:3002/posts/mostraPost',{\n        headers: {accessToken: localStorage.getItem(\"Token\")},\n      }).then((response)=>{\n        \n        console.log(response.data);\n        setPost(response.data.listaPost); //li memorizza dentro lo stato\n        setLikedPosts(response.data.likedPosts.map((like)=>{\n          return like.PostId;\n        }));\n  \n      });\n    }\n   \n\n  }, []);\n\n  \n \n\n  const miPiace = (postId) => {\n    axios.post(\"http://localhost:3002/likes/inserisciLike\",\n\n        { PostId: postId },\n        { headers: { accessToken: localStorage.getItem(\"Token\") } }\n      )\n      .then((response) => {\n        //Dobbiamo aggiornare il post, per farlo dentro il metodo set\n        //andiamo a fare una map\n        //mi arriva il valore dal db, modifico il mio stato ma prima\n        //faccio un controllo e seleziono il post che mi interessa\n        //dopodiche` aggiorno il numero di like\n        setPost(\n          post.map((post)=>{\n          if(post.id === postId){\n            //ritorniamo il vecchio sato, andando a modificare il campo likes, quindi\n            //sommiamo le quantita`\n            if(response.data.liked){\n              return {...post, Likes:[...post.Likes, 0]};\n            }else{ \n              const likesArray =  post.Likes;\n              likesArray.pop(); //rimuovo l;ultimo elemento\n              return {...post, Likes:likesArray};\n            }\n          }else{\n            return post\n          }\n         })\n        );\n\n        if(likedPosts.includes(postId)){\n          setLikedPosts(likedPosts.filter((id)=>{\n            return id != postId;\n          }));\n        }else{\n        setLikedPosts([...likedPosts, postId]);\n        }\n\n      }); \n  };\n\n  //FUNZIONI\n\n  return (\n    <div>\n\n      {post.map((value,key)=>{\n\n            return (\n            \n              <div className='container-post  '>\n                  <div className='items' >\n                  \n                    <div className='nav-post flex-container justify-content align-center'>\n                        <h1>{value.title}</h1>\n                    </div>\n\n                    <div onClick={()=>{navigate(`/Post/${value.id}`);}} className='post-center flex-container justify-content align-center'>\n                        <ul className='list'>\n                        <li>{value.postText}</li>\n                        </ul>\n                    </div>\n\n                    <div className='username-post flex-container align-center '>\n                        <h1 className='text'>{value.username}</h1>\n                        <div className='wrap'>\n                          <button onClick={()=>{miPiace(value.id)}} className={likedPosts.includes(value.id) ? \"likeBtn\" : \"unlikeBtn\"}  > \n                          <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"25\" height=\"25\" fill=\"currentColor\" class=\"bi bi-hand-thumbs-up\" viewBox=\"0 0 16 16\">\n                            <path d=\"M8.864.046C7.908-.193 7.02.53 6.956 1.466c-.072 1.051-.23 2.016-.428 2.59-.125.36-.479 1.013-1.04 1.639-.557.623-1.282 1.178-2.131 1.41C2.685 7.288 2 7.87 2 8.72v4.001c0 .845.682 1.464 1.448 1.545 1.07.114 1.564.415 2.068.723l.048.03c.272.165.578.348.97.484.397.136.861.217 1.466.217h3.5c.937 0 1.599-.477 1.934-1.064a1.86 1.86 0 0 0 .254-.912c0-.152-.023-.312-.077-.464.201-.263.38-.578.488-.901.11-.33.172-.762.004-1.149.069-.13.12-.269.159-.403.077-.27.113-.568.113-.857 0-.288-.036-.585-.113-.856a2.144 2.144 0 0 0-.138-.362 1.9 1.9 0 0 0 .234-1.734c-.206-.592-.682-1.1-1.2-1.272-.847-.282-1.803-.276-2.516-.211a9.84 9.84 0 0 0-.443.05 9.365 9.365 0 0 0-.062-4.509A1.38 1.38 0 0 0 9.125.111L8.864.046zM11.5 14.721H8c-.51 0-.863-.069-1.14-.164-.281-.097-.506-.228-.776-.393l-.04-.024c-.555-.339-1.198-.731-2.49-.868-.333-.036-.554-.29-.554-.55V8.72c0-.254.226-.543.62-.65 1.095-.3 1.977-.996 2.614-1.708.635-.71 1.064-1.475 1.238-1.978.243-.7.407-1.768.482-2.85.025-.362.36-.594.667-.518l.262.066c.16.04.258.143.288.255a8.34 8.34 0 0 1-.145 4.725.5.5 0 0 0 .595.644l.003-.001.014-.003.058-.014a8.908 8.908 0 0 1 1.036-.157c.663-.06 1.457-.054 2.11.164.175.058.45.3.57.65.107.308.087.67-.266 1.022l-.353.353.353.354c.043.043.105.141.154.315.048.167.075.37.075.581 0 .212-.027.414-.075.582-.05.174-.111.272-.154.315l-.353.353.353.354c.047.047.109.177.005.488a2.224 2.224 0 0 1-.505.805l-.353.353.353.354c.006.005.041.05.041.17a.866.866 0 0 1-.121.416c-.165.288-.503.56-1.066.56z\"/>\n                          </svg>\n                          </button>\n                          <label>{value.Likes.length}</label>\n                        </div>\n                    </div>\n                  </div>\n              </div>\n            )\n\n            })}\n    </div>\n  )\n}\n\nexport default Home\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}